{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Crenly</title>
   <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
   <link rel="stylesheet" href="{% static 'accounts/css/global-form-styling.css' %}">
   <link rel="stylesheet" href="{% static 'accounts/css/signup.css' %}">
</head>
<body>
   <div class="wrapper">
      <section class="section-hero d-none">
          <div class="custom-container">
             <div class="section-hero__content">
                  <div class="logo text-center">
                     <img class="logo-img" src="{% static 'accounts/images/crenly-logo.svg' %}" alt="">
                  </div>
                   <h1 class="heading__title font-weight-bold text-center">Gain Better Online Visibility.</h1>
                   <h3 class="heading__sub-title font-weight-bold text-center">Join over 10,000 Happy Marketers!</h3>
             </div>
          </div>
      </section>
      <section class="section-form">
         <div class="section-form__container">
            <div class="mobile-nav">
               <div class="logo d-none-md">
                  <img class="logo-img" src="{% static 'accounts/images/logo-mobile.svg' %}" alt="crenly logo">
               </div>
               <div class="text-right">
                  <a class="btn btn-tour font-weight-bold" href="#">Quick Tour</a>
               </div>
            </div>
            <div class="section-form__text">
               <h2 class="text-center font-weight-bold section-form__text-title">Create Account</h2>
               <h4 class="text-center section-form__text-sub-title">Start your free tier</h4>
            </div>
            <form>
            {% csrf_token %}
               <div class="form-group">
                  <label class="input-label" for="name">Name</label>
                  <div class="input-container">
                     <input class="input-field" type="text" name="name" placeholder="Mark Essien" id="name">
                     <img class="input-icon" src="{% static 'accounts/images/user.svg' %}" alt="user icon">
                  </div>
               </div>
               <div class="form-group">
                  <label class="input-label" for="email">Email Address</label>
                  <div class="input-container">
                     <input class="input-field" type="email" name="email" placeholder="Someone@gmail.com" id="email">
                     <img class="input-icon" src="{% static 'accounts/images/mail.svg' %}" alt="mail icon">
                  </div>
               </div>
               <div class="form-group">
                  <label class="input-label" for="company">Company</label>
                  <div class="input-container">
                     <input class="input-field" type="text" placeholder="Hotels.NG" name="company" id="company">
                     <img class="input-icon" src="{% static 'accounts/images/map.svg' %}" alt="company icon">
                  </div>
               </div>
               <div class="form-group">
                  <label class="input-label" for="psw1">Password</label>
                  <div class="input-container">
                     <input class="input-field" type="password" name="psw1" placeholder="**************" id="psw1">
                     <img class="input-icon" src="{% static 'accounts/images/password.svg' %}" alt="password icon">
                  </div>
               </div>
               <div class="form-group">
                  <label class="input-label" for="psw2">Confirm Password</label>
                  <div class="input-container">
                     <input class="input-field" type="password" name="psw2" placeholder="**************" id="psw2">
                     <img class="input-icon" src="{% static 'accounts/images/password.svg' %}" alt="password icon">
                  </div>
               </div>
               <div class="btn-submit-container">
                  <button class="btn btn-submit font-weight-bold" type="submit">Sign Up</button>
               </div>
               <p class="error_message"></p>
            </form>
            <p class="text-center form__alternative-text">Already have an account? <a class="link font-weight-bold" href="../login">Login</a></p>
         </div>
      </section>
   </div>
      <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    {% comment %} <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> {% endcomment %}

    <script>
    $(document).ready(function(){
     $("form").submit(function(event){
      event.preventDefault();
      var name = $("#name").val();
      var email = $("#email").val();
      var password = $("#psw1").val();
      var password_len = $("#psw1").val().length;
      var password2 = $("#psw2").val();
      var company = $("#company").val();
      var submit =    $("#submit").val();
      function checkStringForNumbers(input){


   //var validate = function(input){
             let str = String(input);
            for( let i = 0; i < str.length; i++){
                  //   console.log(str.charAt(i));
               if(!isNaN(str.charAt(i))){           //if the string is a number, do the following
                     return true;
                     break;
               }
            }
        // }
   }


    if(name==''){
        $("#name").css({"background-color": "transparent", "border-color": "red"});
        $(".error_message").html("<p style='' class='error-alert'>Name field is empty</p>");
    }else{
      $("#name").css({"border-color": "green"});
          if(email==''){
            $("#email").css({"background-color": "transparent", "border-color": "red"});
    }else{
            $("#email").css({"border-color": "green"});
                if(password==''){
                   $(".error_message").html("<p style='' class='error-alert'>Password field is empty</p>");
                  $("#psw1").css({"background-color": "transparent", "border-color": "red"});
    }else{
                $("#psw1").css({"border-color": "green"});

                if(password_len < 8){
                   $(".error_message").html("<p style='' class='error-alert'>Password must be at least 8 characters</p>");
                  $("#psw1").css({"background-color": "transparent", "border-color": "red"});
    }else{
                $("#psw1").css({"border-color": "green"});

                  if(checkStringForNumbers(password) != true){
                   $(".error_message").html("<p style='' class='error-alert'>Password must contain a number</p>");
                  $("#psw1").css({"background-color": "transparent", "border-color": "red"});
    }else{
                $("#psw1").css({"border-color": "green"});
                if(password2==''){
                   $(".error_message").html("<p style='' class='error-alert'>Confirm your password</p>");
                  $("#psw2").css({"background-color": "transparent", "border-color": "red"});
    }else{
                $("psw2").css({"border-color": "green"});
                if(password != password2){
                  $("#psw1").css({"background-color": "transparent", "border-color": "red"});
                  $("#psw2").css({"background-color": "transparent", "border-color": "red"});
                  $(".error_message").html("<p class='error-alert' style='text-align:center'>Passwords do not match<p>");
    }else{
      $("#psw1").css({"border-color": "green"});
      $("psw2").css({"border-color": "green"});
                if(company==''){
                    $(".error_message").html("<p style='' class='error-alert'>Enter your company's name</p>");
                  $("#company").css({"background-color": "transparent", "border-color": "red"});

    }else{
       $(".error_message").html("<p style='' class='success-alert'>Please wait...</p>");
$.ajax({

    type: "POST",
    url: window.location.protocol + "//" + window.location.host +"/signup/",
//    contentType: "application/json",
//    dataType: "json",
    data: {       csrfmiddlewaretoken: document.getElementsByName('csrfmiddlewaretoken')[0].value,
                  name : name,
                  email : email,
                  password : password,
                  company : company,
                  submit : submit
    },
    success: function(response) {
$(".error_message").html(response);

        
    },
    error: function(response) {
 $(".error_message").html("<p class='error-alert' style='text-align:center'>An error occured<p>");
     }       

            
            });


 
                }
              }
            }
          }
    }
    }
      }
    }




     });   
    });
</script>
</body>
</html>